Даны некоторые образовательные курсы и данные по ним в следующих таблицах: 

![image-2.png](attachment:image-2.png)

![image-3.png](attachment:image-3.png)

![image-4.png](attachment:image-4.png) 

Курсы состоят из различных уроков, каждый из которых состоит из нескольких маленьких заданий. Назовём очень усердным учеником того пользователя, который хотя бы раз за текущий месяц правильно решил 20 горошин.

Задание 1. Необходимо написать оптимальный запрос, который даст информацию о количестве очень усердных студентов.
Задание 2. На образовательной платформе был проведен эксперимент, где был протестирован новый экран оплаты. Необходимо в одном запросе выгрузить следующую информацию о группах пользователей: ARPU ARPAU CR в покупку СR активного пользователя в покупку CR пользователя из активности по математике (subject = ’math’) в покупку курса по математике ARPU считается относительно всех пользователей, попавших в группы. Активным считается пользователь, за все время решивший больше 10 задач правильно в любых дисциплинах. Активным по математике считается пользователь, за все время решивший 2 или больше задач правильно по математике.
Все данные находятся в табличном виде в Clickhouse. Подключение к ClickHouse через Python c использованием библиотеки pandahouse.
